---
title: "React Routerã§ã‚¨ãƒ©ãƒ¼ç”»é¢ã®å®Ÿè£…ãŒç°¡å˜ã«ãªã£ã¦ã„ãŸã®ã§å®Ÿè£…"
emoji: "ğŸŒŸ"
type: "tech"
topics: []
published: false
---

ã“ã‚“ã°ã‚“ã‚âœ‹ã€@nerusanã§ã™ã€‚

Webã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã«ãŠã„ã¦ã€ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°å‡¦ç†ã‚’è¡Œã†ã®ã¯ã€å¿…é ˆã§ã™ã€‚
ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã‚’å®Ÿç¾ã™ã‚‹ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®ä¸€ã¤ã¨ã—ã¦ã€React RouterãŒã‚ã‚Šã¾ã™ã€‚

https://reactrouter.com/en/main

React Routerã®ãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«ã‚’è¦‹ã¦ã„ã‚‹ã¨ã€ã‚¨ãƒ©ãƒ¼å‡¦ç†ãŒç°¡å˜ã«å®Ÿè£…ã§ãã‚‹ã“ã¨ã«æ°—ã¥ã„ãŸã®ã§ã€å…±æœ‰ã¨ã—ã¦ã¾ã¨ã‚ã¾ã™ã€‚

ä»¥ä¸‹ãŒãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«ã«ãªã‚Šã¾ã™ã€‚
react-routerã‚’ä½¿ã†ã“ã¨ãŒã‚ã‚‹äººã¯ãœã²ä¸€é€šã‚Šå®Ÿè·µã—ã¦ã¿ã¦ãã ã•ã„ï¼

https://reactrouter.com/en/main/start/tutorial

:::message
æœ¬è¨˜äº‹ã§ã¯ã€Reactï¼‘ï¼˜ã®Suspenseã‚’åˆ©ç”¨ã‚’å‰æã¨ã—ãŸè©±ã‚’é€²ã‚ã¾ã™ã€‚
:::

# ç’°å¢ƒ
ä»Šå›ç´¹ä»‹ã™ã‚‹ã‚³ãƒ¼ãƒ‰ã§ã¯ã€ä»¥ä¸‹ã®ç’°å¢ƒã§è¨˜è¿°ã•ã‚Œã¦ã„ã¾ã™ã€‚

- React v18.2.0
- vite v3.1.0
- axios v1.2.0
- [@tanstack/react-query v4.18.0](https://tanstack.com/query/v4/?from=reactQueryV3&original=https://react-query-v3.tanstack.com/)
- @mui/material v5.11.0
- react-hook-form v7.39.6

# ä½œã‚‹ã‚‚ã®

ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã€åå‰ã€ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã§ãƒ¦ãƒ¼ã‚¶ç™»éŒ²ã‚’è¡Œã†æ©Ÿèƒ½ã‚’è€ƒãˆã¾ã™ã€‚

![](https://storage.googleapis.com/zenn-user-upload/167f54c61f87-20230105.png)

# ã“ã‚Œã¾ã§ã®ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°
Suspenseã‚’åˆ©ç”¨ã—ãŸéš›ã®ã€ã‚¨ãƒ©ãƒ¼ç”»é¢ã¯ã€react-error-boundaryã‚’åˆ©ç”¨ã™ã‚‹ã®ãŒä¸€èˆ¬çš„ã‹ãªã£ã¦æ€ã„ã¾ã™ã€‚

https://github.com/bvaughn/react-error-boundary

react-error-boundaryãŒä¾‹å¤–ã‚’ã‚­ãƒ£ãƒƒãƒã—ã€ã‚¨ãƒ©ãƒ¼ç”»é¢ã‚’è¡¨ç¤ºã™ã‚‹ã¨ã„ã†æµã‚Œã«ãªã‚Šã¾ã™ã€‚

react-error-boundaryã‚’åˆ©ç”¨ã—ãŸå®Ÿè£…ä¾‹ã‚’ä»¥ä¸‹ã«ç¤ºã—ã¾ã™ã€‚ãŸã ã€ã“ã¡ã‚‰ã§ã¯ã€åˆ†ã‹ã‚Šã‚„ã™ã•ã‚’å„ªå…ˆã™ã‚‹ãŸã‚ã€ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°å‡¦ç†ã‚’ã—ã¦ã„ã¾ã›ã‚“ã€‚

```ts:src/providers/app.tsx
import { queryClient } from "@/lib/react-query";
import {
  QueryClientProvider,
  QueryErrorResetBoundary,
} from "@tanstack/react-query";
import * as React from "react";
import { ErrorBoundary } from "react-error-boundary";

/**
 * ã‚¨ãƒ©ãƒ¼ç”»é¢
 * @param param0
 * @returns
 */
const ErrorFallback = ({
  reset,
  error,
}: {
  reset: (...args: unknown[]) => void;
  error: Error;
}) => {
  return (
    <div role="alert">
      <h2>ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸã€‚</h2>
      <p>{error.message}</p>
      <button onClick={() => reset()}>ãƒ›ãƒ¼ãƒ ã¸</button>
    </div>
  );
};

type AppProviderProps = {
  children: React.ReactNode;
};

/**
 * ãƒ—ãƒ­ãƒ‘ã‚¤ãƒ€ãƒ¼
 */
export const AppProvider = ({ children }: AppProviderProps) => {
  return (
    <QueryErrorResetBoundary>
      {({ reset }) => (
        <ErrorBoundary
          onReset={reset}
          fallbackRender={({ resetErrorBoundary, error }) => (
            <ErrorFallback reset={resetErrorBoundary} error={error} />
          )}
        >
          <React.Suspense fallback={<div>loading...</div>}>
            <QueryClientProvider client={queryClient}>
              {children}
            </QueryClientProvider>
          </React.Suspense>
        </ErrorBoundary>
      )}
    </QueryErrorResetBoundary>
  );
};
```

```ts:src/lib/react-query.ts
import { DefaultOptions, QueryClient } from "@tanstack/react-query";
import { AxiosError } from "axios";

const queryConfig: DefaultOptions<
  AxiosError<{ statusCode: number; title: string; message: string }>
> = {
  queries: {
    suspense: true,
    useErrorBoundary(error) {
      // 500ã‚¨ãƒ©ãƒ¼ã¯ä¾‹å¤–ã‚¨ãƒ©ãƒ¼ã¨ã—ã¦ã‚­ãƒ£ãƒƒãƒã•ã›ã‚‹
      if (error.response) {
        return error.response?.status >= 500;
      }
      return true;
    },
    refetchOnWindowFocus: false,
    retry: false,
  },
  mutations: {
    useErrorBoundary(error) {
      // 500ã‚¨ãƒ©ãƒ¼ã¯ä¾‹å¤–ã‚¨ãƒ©ãƒ¼ã¨ã—ã¦ã‚­ãƒ£ãƒƒãƒã•ã›ã‚‹
      if (error.response) {
        return error.response?.status >= 500;
      }
      return true;
    },
  },
};

export const queryClient = new QueryClient({
  defaultOptions: queryConfig as DefaultOptions,
});
```


```tsx:src/pages/Signup.tsx
import {
  ERR_MAIL_FORMAT_MESSAGE,
  ERR_REQUIRE_MESSAGE,
  MAIL_FORMAT_REGEXP,
} from "@/const/const";
import { LoadingButton } from "@mui/lab";
import { Box, TextField } from "@mui/material";
import { useMutation } from "@tanstack/react-query";
import { AxiosError } from "axios";
import React from "react";
import { useForm } from "react-hook-form";
import {
  registerWithEmailAndPassword,
  RegisterCredentialsDTO,
} from "../api/register";

/**
 * ã‚µã‚¤ãƒ³ã‚¢ãƒƒãƒ—æ©Ÿèƒ½
 */
export const Signup: React.FC = React.memo(() => {
  const [userId, setUserId] = React.useState<string>("");
  const {
    register,
    handleSubmit,
    getValues,
    setError,
    formState: { errors },
  } = useForm({
    defaultValues: {
      email: "",
      familyName: "",
      familyNameKana: "",
      firstName: "",
      firstNameKana: "",
      password: "",
    },
  });

  const { mutate, isLoading } = useMutation(
    (data: RegisterCredentialsDTO) =>
      registerWithEmailAndPassword(data),
    {
      onSuccess: (res) => {
        setUserId(res.data.data.userId);
      },
      onError: (
        err: AxiosError<{ statusCode: number; title: string; message: string }>
      ) => {
        if (err.response?.status === 409) {
          setError("email", { message: err.response.data.message });
          return;
        }
      },
    }
  );

  return (
    <Box className="App" mx="auto" maxWidth="400px">
      <h2>
        <Box textAlign="center">ã‚¢ã‚«ã‚¦ãƒ³ãƒˆæ–°è¦ç™»éŒ²</Box>
      </h2>
      <form onSubmit={handleSubmit((data) => mutate(data))}>
        <Box marginBottom="24px">
          <Box mb="4px">ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹</Box>
          <TextField
            fullWidth
            placeholder="yamada.taro@example.com"
            variant="outlined"
            type="email"
            {...register("email", {
              required: { value: true, message: ERR_REQUIRE_MESSAGE },
              pattern: {
                value: MAIL_FORMAT_REGEXP,
                message: ERR_MAIL_FORMAT_MESSAGE,
              },
            })}
          />
          <Box sx={{ color: "error.main" }}>{errors.email?.message}</Box>
        </Box>
        <Box marginBottom="24px">
          <Box mb="4px">å§“ï¼ˆå…¨è§’ï¼‰</Box>
          <TextField
            fullWidth
            placeholder="å±±ç”°"
            type="text"
            variant="outlined"
            {...register("familyName", {
              required: { value: true, message: ERR_REQUIRE_MESSAGE },
            })}
          />
          <Box sx={{ color: "error.main" }}>{errors.familyName?.message}</Box>
        </Box>
        <Box marginBottom="24px">
          <Box mb="4px">åï¼ˆå…¨è§’ï¼‰</Box>
          <TextField
            fullWidth
            placeholder="å¤ªéƒ"
            type="text"
            variant="outlined"
            {...register("familyNameKana", {
              required: { value: true, message: ERR_REQUIRE_MESSAGE },
            })}
          />
          <Box sx={{ color: "error.main" }}>
            {errors.familyNameKana?.message}
          </Box>
        </Box>
        <Box marginBottom="24px">
          <Box mb="4px">å§“ã‚«ãƒŠï¼ˆå…¨è§’ï¼‰</Box>
          <TextField
            fullWidth
            placeholder="ãƒ¤ãƒãƒ€"
            type="text"
            variant="outlined"
            {...register("firstName", {
              required: { value: true, message: ERR_REQUIRE_MESSAGE },
            })}
          />
          <Box sx={{ color: "error.main" }}>{errors.firstName?.message}</Box>
        </Box>
        <Box marginBottom="24px">
          <Box mb="4px">åã‚«ãƒŠï¼ˆå…¨è§’ï¼‰</Box>
          <TextField
            fullWidth
            type="text"
            placeholder="ã‚¿ãƒ­ã‚¦"
            variant="outlined"
            {...register("firstNameKana", {
              required: { value: true, message: ERR_REQUIRE_MESSAGE },
            })}
          />
          <Box sx={{ color: "error.main" }}>
            {errors.firstNameKana?.message}
          </Box>
        </Box>
        <Box marginBottom="24px">
          <Box mb="4px">ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰</Box>
          <TextField
            fullWidth
            type="password"
            variant="outlined"
            {...register("password", {
              required: { value: true, message: ERR_REQUIRE_MESSAGE },
            })}
          />
          <Box sx={{ color: "error.main" }}>{errors.password?.message}</Box>
        </Box>
        <LoadingButton
          size="large"
          fullWidth
          sx={{ marginTop: "50px" }}
          variant="contained"
          type="submit"
          color="primary"
          loading={isLoading}
        >
          ç™»éŒ²
        </LoadingButton>
	{userId && <p>ãƒ¦ãƒ¼ã‚¶IDã¯{userId}ã§ã™ã€‚</p>}
      </form>
    </Box>
  );
});
```

ã“ã“ã§ã®ãƒã‚¤ãƒ³ãƒˆã¯ã€2ç‚¹ã§ã™ã€‚

1ç‚¹ç›®ã¯ã€ä¾‹å¤–ã‚’ã‚­ãƒ£ãƒƒãƒã—ãŸã„JSXã‚’`ErrorBoudnary`ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã§æ‹¬ã‚Šã¾ã™ã€‚
ä»Šå›ã¯ã€`src/providers/app.tsx`ã§ ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å…¨ä½“ã‚’æ‹¬ã‚Šã¾ã™ã€‚
å­ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã§ä¾‹å¤–ãŒç™ºç”Ÿã—ãŸã‚‰ã€ä¾‹å¤–ã‚’ã‚­ãƒ£ãƒƒãƒã—ã¦ã€`fallbackRender`ã«æŒ‡å®šã•ã‚ŒãŸã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆãŒã‚¨ãƒ©ãƒ¼ç”»é¢ã¨ã—ã¦è¡¨ç¤ºã•ã‚Œã¾ã™ã€‚

ã¾ãŸã€ã‚¯ã‚¨ãƒªã§ suspense ã‚„ useErrorBoundaries ã‚’ä½¿ç”¨ã™ã‚‹å ´åˆã€ä½•ã‚‰ã‹ã®ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ãŸå¾Œã«å†æç”»ã™ã‚‹éš›ã«ã‚¯ã‚¨ãƒªã«å†è©¦è¡Œã™ã‚‹ã“ã¨ã‚’çŸ¥ã‚‰ã›ã‚‹æ–¹æ³•ãŒå¿…è¦ã«ãªã‚Šã¾ã™ã€‚

ã‚¯ã‚¨ãƒªã®ã‚¨ãƒ©ãƒ¼ã¯ã€`QueryErrorResetBoundary` ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚ã‚‹ã„ã¯ useQueryErrorResetBoundary ãƒ•ãƒƒã‚¯ã§ãƒªã‚»ãƒƒãƒˆã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

è©³ã—ãã¯ä»¥ä¸‹ã®ãƒšãƒ¼ã‚¸ã‚’å‚è€ƒã«ã—ã¦ãã ã•ã„ã€‚

https://tanstack.com/query/v4/docs/react/guides/suspense#resetting-error-boundaries

ä»Šå›ã¯ã€`QueryErrorResetBoundary`ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’åˆ©ç”¨ã—ã¦ã„ã¾ã™ã€‚

2ç‚¹ç›®ã¯ã€@tanstack/react-qeuryã§error-boundaryã®åˆ©ç”¨ã‚’è¨­å®šã—ã¾ã™ã€‚
`src/lib/react-query.ts`ã«ã¦ã‚°ãƒ­ãƒ¼ãƒãƒ«ã«è¨­å®šã‚’ã—ã¦ã„ã¾ã™ã€‚

queriesã¨mutationsãã‚Œãã‚Œã«å¯¾ã—ã¦ã€`useErrorBoundary`ã‚’trueã«ã™ã‚‹ã¨è¨­å®šã§ãã¾ã™ã€‚
ã“ã“ã§ã¯ã€ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚³ãƒ¼ãƒ‰500ç•ªå°ä»¥ä¸Šã®ã‚¨ãƒ©ãƒ¼ã®ã¿ã‚¨ãƒ©ãƒ¼ç”»é¢ã‚’è¡¨ç¤ºã™ã‚‹ã‚ˆã†ã«è¨­å®šã—ã¦ã„ã¾ã™ã€‚

ä»Šå›ã®ä¾‹ã ã¨ã€ç™»éŒ²æ¸ˆã¿ã®ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã§ç™»éŒ²ã—ã‚ˆã†ã¨ã™ã‚‹å ´åˆã€409ãŒè¿”å´ã•ã‚Œã¾ã™ãŒã€ã“ã®æ™‚ã€ã‚¨ãƒ©ãƒ¼ç”»é¢ã«é·ç§»ã—ãŸãã‚ã‚Šã¾ã›ã‚“ã€‚
é·ç§»ã™ã‚‹ã¨ã€å†åº¦ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’å…¥åŠ›ã—ã¦ã‚‚ã‚‰ã†ã“ã¨ãŒã§ããªã„ãŸã‚ã§ã™ã€‚ï¼ˆãƒªãƒ­ãƒ¼ãƒ‰ã—ãŸã‚‰ã„ã‘ã¾ã™ãŒã€åå‰ã‚‚å…¥åŠ›ã—ç›´ã—ã«ãªã‚‹ãŸã‚ã€ã‚ã‚“ã©ãã•ã„ã§ã™ã€‚ï¼‰

â–¼ã‚¨ãƒ©ãƒ¼ç”»é¢ã«é·ç§»ã™ã‚‹ã¨å†åº¦ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹å…¥åŠ›ã§ããªã„âŒ
![](https://storage.googleapis.com/zenn-user-upload/e4e0959ec22f-20230104.png)

â–¼ã‚¨ãƒ©ãƒ¼ç”»é¢ã«é·ç§»ã•ã›ãšå†åº¦ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹å…¥åŠ›ã§ãã‚‹ã‚ˆã†ã«ã™ã‚‹â­•ï¸
![](https://storage.googleapis.com/zenn-user-upload/7c24c1465309-20230104.png)


# React Routerã‚’åˆ©ç”¨ã—ãŸå ´åˆ

æ¬¡ã«ã€React Routerã‚’åˆ©ç”¨ã—ãŸæ–¹æ³•ã‚’ç´¹ä»‹ã—ã¾ã™ã€‚


```tsx:src/providers/app.tsx
import { AuthProvider } from "@/lib/auth";
import { queryClient } from "@/lib/react-query";
import { getAppRoutes } from "@/routes";
import {
  Box,
  CircularProgress,
  createTheme,
  ThemeProvider,
} from "@mui/material";
import { QueryClientProvider } from "@tanstack/react-query";
import * as React from "react";
import { RouterProvider } from "react-router-dom";
import { RecoilRoot } from "recoil";

type AppProviderProps = {
  children?: React.ReactNode;
};

/**
 * ãƒ—ãƒ­ãƒ‘ã‚¤ãƒ€ãƒ¼
 */
export const AppProvider = ({ children }: AppProviderProps) => {
  const theme = createTheme({});
  return (
    <RecoilRoot>
      <React.Suspense
        fallback={
          <Box
            display="flex"
            alignItems="center"
            justifyContent="center"
            height="100vh"
          >
            <CircularProgress />
          </Box>
        }se
      >
        <QueryClientProvider client={queryClient}>
          <AuthProvider>
            <ThemeProvider theme={theme}>
              <RouterProvider router={getAppRoutes()} />
            </ThemeProvider>
          </AuthProvider>
        </QueryClientProvider>
      </React.Suspense>
    </RecoilRoot>
  );
};
```

```tsx:src/routes/index.tsx
import { Error } from "@/components/Error";
import { createBrowserRouter, redirect, RouteObject } from "react-router-dom";
import { publicRoutes } from "./public";
const { SignupPage } = lazyImport(() => import("@/pages/Signup"), "SignupPage");

/**
 * ãƒ­ã‚°ã‚¤ãƒ³ã—ã¦ã„ãªã„æ™‚ã§ã‚‚ã¿ã‚Œã‚‹ãƒšãƒ¼ã‚¸ä¸€è¦§
 */
export const publicRoutes: RouteObject[] = [
  {
    path: "/",
    element: <Layout />,
    errorElement: <Error />,
    children: [{ path: "/signup", element: <SignupPage /> }],
  },
];

/**
 * å…¨ä½“ã®ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã®è¨­å®š
 */
export const getAppRoutes = () => {
  const commonRoutes: RouteObject[] = [
    {
      path: "/",
      errorElement: (
        <Error
          title="404"
          message="ã“ã®ãƒšãƒ¼ã‚¸ã¯ã™ã§ã«å‰Šé™¤ã•ã‚Œã¦ã„ã‚‹ã‹ã€URLãŒé–“é•ã£ã¦ã„ã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚"
        />
      ),
    },
  ];

  const routes = publicRoutes;
  const root = createBrowserRouter([...commonRoutes, ...routes]);
  return root;
};
```

```tsx:src/components/Error.tsx
import { Box, Button } from "@mui/material";
import { useQueryErrorResetBoundary } from "@tanstack/react-query";
import { AxiosError } from "axios";
import { useRouteError } from "react-router-dom";

type Props = {
  title?: string;
  message?: string;
};

/**
 * ã‚¨ãƒ©ãƒ¼ç”»é¢
 * @param param0
 * @returns
 */
export const Error = ({ title, message }: Props) => {
  // ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ãŸæ™‚ã®æƒ…å ±ã‚’å–å¾—ã™ã‚‹
  const error = useRouteError() as AxiosError<{
    statusCode: number;
    title: string;
    message: string;
  }>;
  const { reset } = useQueryErrorResetBoundary();

  return (
    <Box
      role="alert"
      display="flex"
      alignItems="center"
      justifyContent="center"
      height="100vh"
      flexDirection="column"
    >
      <h1>
        {title || error.response?.data.title || "ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸã€‚"}
      </h1>
      <p>{message || error.response?.data.message || error.message}</p>
      <Button
        variant="outlined"
        onClick={() => {
          reset();
          window.location.assign(window.location.origin);
        }}
      >
        ãƒ›ãƒ¼ãƒ ã¸
      </Button>
    </Box>
  );
};
```

`src/pages/Signup.tsx`ã€`src/lib/react-query.ts`ã¯react-error-boundaryã®æ™‚ã¨åŒã˜ã§ã™ã€‚500ç•ªå°ã®å ´åˆã®ã¿ã‚¨ãƒ©ãƒ¼ç”»é¢ã‚’å‡ºã—ã¾ã™ã€‚

ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼(`src/providers/app.tsx`)ã§ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã®è¨­å®šã¯åŠ ãˆã¦ã„ã¾ã™ãŒã€ä¾‹å¤–ã‚­ãƒ£ãƒƒãƒã®ãŸã‚åˆ¥é€”å­ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’æ‹¬ã‚‹å¿…è¦ãŒãªããªã£ãŸãŸã‚ã€ã™ã£ãã‚Šã—ã¾ã—ãŸã€‚

ã‚¨ãƒ©ãƒ¼ã®è¨­å®šã‚’ã—ã¦ã„ã‚‹ã®ã¯ã€ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã‚’è¨­å®šã—ã¦ã„ã‚‹`src/routes/index.tsx`ã«ãªã‚Šã¾ã™ã€‚é…ä¸‹ã®ãƒšãƒ¼ã‚¸(elemnentã«æŒ‡å®šã—ãŸã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ)ã€ã¾ãŸã¯ã€ãƒ­ãƒ¼ãƒ€ãƒ¼ã€ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã§ãªã«ã‹ä¾‹å¤–ãŒç™ºç”Ÿã—ãŸã‚‰ã€`errorElement`ã«æŒ‡å®šã—ãŸã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆãŒã‚¨ãƒ©ãƒ¼ç”»é¢ã¨ã—ã¦è¡¨ç¤ºã•ã‚Œã¾ã™ã€‚

```tsx:
  const commonRoutes: RouteObject[] = [
    {
      path: "/signup",
      element: <Signup />, // 1
      loader: loaderFn,    // 2
      action: actionFn,    // 3
      errorElement: (      // 1, 2, 3ã®ã„ãšã‚Œã‹ã§ä¾‹å¤–ãŒç™ºç”Ÿã—ãŸã‚‰ã€errorElementã«æŒ‡å®šã•ã‚ŒãŸã‚¨ãƒ©ãƒ¼ç”»é¢ã‚’è¡¨ç¤º 
        <Error />
      ),
    },
  ];
```

ç™ºç”Ÿã—ãŸã‚¨ãƒ©ãƒ¼ã«ã¤ã„ã¦ã®æƒ…å ±ã¯ã€`useRouteError`ã‚’åˆ©ç”¨ã™ã‚‹ã“ã¨ã§ã€å–å¾—ã§ãã¾ã™ã€‚
`src/components/Error.tsx`ã¯å®Ÿéš›ã«è¡¨ç¤ºã™ã‚‹ã‚¨ãƒ©ãƒ¼ç”»é¢ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã§ã™ã€‚ã‚¨ãƒ©ãƒ¼æƒ…å ±ã¯ã€propsã‹ã‚‰ã‚‚æŒ‡å®šã™ã‚‹ã“ã¨ãŒã§ãã‚‹ã‚ˆã†ã«ã—ã¦ã„ã¾ã™ã€‚

ã¾ãŸã€ãƒ«ãƒ¼ãƒˆ`/`ã«å¯¾ã—ã¦`errorElemnt`ã‚’æŒ‡å®šã™ã‚‹ã“ã¨ã§ã€å­˜åœ¨ã—ãªã„ãƒšãƒ¼ã‚¸ã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ã¨ã‚¨ãƒ©ãƒ¼ç”»é¢ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚

â–¼å­˜åœ¨ã—ãªã„`/signhoge`ã«ã‚¢ã‚¯ã‚»ã‚¹
![](https://storage.googleapis.com/zenn-user-upload/00949de79e4d-20230105.png)

â–¼500ã‚¨ãƒ©ãƒ¼ã‚‚ã—ã£ã‹ã‚Šè¡¨ç¤ºã•ã‚Œã‚‹
![](https://storage.googleapis.com/zenn-user-upload/931e6d1e7c6d-20230105.png)

# ã¾ã¨ã‚
ã„ã‹ãŒã§ã—ãŸã‹ã€‚
ä»–ã«ã‚‚ã€ãƒ­ã‚°ã‚¤ãƒ³çŠ¶æ³ã«å¿œã˜ãŸãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆå‡¦ç†(ãƒ­ã‚°ã‚¤ãƒ³çŠ¶æ…‹å‡ºãªã‘ã‚Œã°ã€`/login`ã«é£›ã°ã™ãªã©)ãªã©ã‚‚ç°¡å˜ã«å®Ÿè£…ãŒã§ããã†ã€‚

ã¾ãŸã€




